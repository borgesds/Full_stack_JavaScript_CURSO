=>Abrir o terminal do vs code e dar um comando de init

$ npm init -y

=>Instalar as dependÃªncias que iremos precisar (sequelize e banco de dados) Estamos instalando o express para usar mais na frente, nÃ£o agora!

$ npm install sequelize pg pg-hstore express

=>Agora iremos fazer a instalaÃ§Ã£o do sequelize-cli, que farÃ¡ uma organizaÃ§Ã£o bÃ¡sica

$ sudo npm install -g sequelize-cli

$ sudo npm install sequelize-cli -D

=>E agora iremos dar inÃ­cio as pastas do nosso projeto, nÃ£o sÃ£o todas as pastas que iremos usar inicialmente, mas ao longo do tempo iremos ocupando elas!

$ sequelize-cli init

=>Agora vamos na pasta config, iremos excluir o arquivo dentro dela e criar um novo arquivo, com o mesmo nome sÃ³ que JS â€œconfig.jsâ€ e vamos inserir o cÃ³digo:

module.exports = {
  dialect: "postgres",
  host: "localhost",
  username: "postgres",
  password: "123456",
  database: "curso_sequelize",
  define: {
    timestamps: true,
  },
};

=>Agora iremos criar o nosso DB com um comando vindo do cli tambÃ©m. VocÃª entra no terminal

$ sequelize db:create


=>Vamos comeÃ§ar com um comando no terminal, na mesma pasta da aula passada!

$ sequelize migration:create --name=planets

=>Ele cria um up e um down jÃ¡ com um exemplo aqui em comentÃ¡rio, nos vamos tirar esse exemplo de comentÃ¡rio, tanto de up quanto de down

=>Up, serve para fazer fazer alguma aÃ§Ã£o, nesse caso criar tabelas, o down para vocÃª desfazer comentÃ¡rios, por isso eles precisam ser alterados juntos

=>Vamos primeiro alterar o nome da tabela, que estÃ¡ entre â€œâ€ de users para planets, depois vamos adicionar mais configuraÃ§Ãµes dentro dos {} onde estÃ¡ inicialmente o id.

up: async (queryInterface, Sequelize) => {
    await queryInterface.createTable("planets", { id: Sequelize.INTEGER });
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.dropTable("planets");
  },

=>Vamos agora adicionar informaÃ§Ãµes para a nossa tabela, jÃ¡ temos o ID, mas vamos adicionar informaÃ§Ãµes nesse id e tambÃ©m outras informaÃ§Ãµes que queremos ter na tabela.

"use strict";

module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.createTable("planets", {
      id: {
        type: Sequelize.INTEGER,
        autoIncrement: true,
        allowNull: false,
        primaryKey: true,
      },
      name: {
        type: Sequelize.STRING,
        allowNull: false,
      },
      position: {
        type: Sequelize.INTEGER,
        allowNull: false,
      },
      createdAt: {
        type: Sequelize.DATE,
      },
      updatedAt: {
        type: Sequelize.DATE,
      },
    });
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.dropTable("planets");
  },
};

=>Agora, iremos dar um comando de terminal para fazer a criaÃ§Ã£o do nosso migrate

$ sequelize db:migrate

=>E agora vocÃª pode verificar no terminal se foi criado com sucesso. Pode tambÃ©m ir ver atravÃ©s do terminal a criaÃ§Ã£o dele, mas caso queira, temos tambÃ©m alternativas visuais, uma delas Ã© o pgAdmin, que vocÃª pode baixar e configurar por esse link: https://www.pgadmin.org/

=>VocÃª vendo atravÃ©s do pgadmin, pode verificar que tem duas tabelas, uma que vocÃª criou e outra que se chama SequelizeMeta. Nela estarÃ£o os comandos que vocÃª deu atravÃ©s do â€œdb:migrateâ€. Isso serve para controle e tambÃ©m para o comando para desfazer, que caso vocÃª queira testar agora, basta digitar

$ sequelize db:migrate:undo

=>E agora a sua tabela sumiu, mas dando â€œdb:migrateâ€ ela vai voltar ao normal. Isso Ã© Ãºtil caso vocÃª tenha colocado um item errado. Mas nÃ£o pode fazer isso depois que jÃ¡ foi para produÃ§Ã£o.

=>Vamos criar dentro da pasta config um arquivo chamado sequelize.js, ele terÃ¡ as configuraÃ§Ãµes que iremos usar no topo dos nossos models!

const Sequelize = require("sequelize");
const database = require("./config");

const sequelize = new Sequelize(database);

module.exports = sequelize;

=>Vamos criar um arquivo chamado de â€œPlanet.jsâ€ dentro de models e tambÃ©m vamos criar um arquivo chamado de â€œindex.jsâ€ na raiz do projeto. Primeiro vamos fazer a config de Planet.js

const { DataTypes } = require("sequelize");
const sequelize = require("../config/sequelize");

const Planet = sequelize.define("planets", {
  name: DataTypes.STRING,
  position: DataTypes.INTEGER,
});

module.exports = Planet

=>3. Agora iremos fazer as configuraÃ§Ãµes dentro de â€œindex.jsâ€ Para que possamos inserir aqui e fazer outras configs tambÃ©m!

(async () => {
  const Planet = require("./models/Planet");

  const newPlanet = await Planet.create({
    name: "Terra",
    position: 3,
  });
  console.log(newPlanet);
})();

=>4. Agora, rodando um comando no terminal, teremos a confirmaÃ§Ã£o no prÃ³prio terminal se estÃ¡ correto ou nÃ£o e se foi criado ou nÃ£o!

$ node index

=>E com isso, vocÃª pode criar quantos planetas quiser, vamos criar mais 2 apenas para ter conteÃºdo suficiente para ler quando fizermos o read (Venus e marte)


=>Atualizando valores via sequelize

Vamos fazer aqui mais um mÃ©todo do CRUD, que Ã© o de Update, nesse caso, iremos criar um mÃ©todo para atualizar valores

=>remos aqui comeÃ§ar com a criaÃ§Ã£o desse mÃ©todo na pasta index.js. Iremos copiar o mÃ©todo que criamos de achar, para alterar em cima disso!

const updatePlanets = await Planet.findByPk(1);
  updatePlanets.name = "Terra616";

  await updatePlanets.save();
  console.log(updatePlanets);

=>2. Fazendo isso, conseguimos alterar o nome do planeta com ID 1, que antes era sÃ³ terra, virou terra 616, que Ã© uma referÃªncia para a marvel ğŸ˜„